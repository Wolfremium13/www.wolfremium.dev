---
title: "ğŸ§ª Testing en Data Engineering"
date: "2022-04-24"
preview: "/assets/blog/testing-on-data-engineering/testing-data-logo.jpg"
tags:
  - "ğŸ‘¨â€ğŸ’» Aprendizaje"
---

# ğŸ§ª Testing en Data Engineering

En estos Ãºltimos meses he visto la importancia de validaciones o tests a la hora
de trabajar con datos, pero claro, normalmente estarÃ¡s acostumbrado a ver test
unitario, test de integraciÃ³n o test e2e. Al empezar a aplicar test me di cuenta
de algo, resulta quÃ© realmente el concepto es el mismo sÃ³lo que cambia el
contexto. Voy a aplicarlos de manera abstracta para quÃ© puedas hacerte una idea.

## Schema Testing

Consiste en comprobar si la estructura de los datos es realmente la correcta
antes de almacenar un dato, por ejemplo validar quÃ© un campo â€œemailâ€ es de el
tipo deseado `str`, que no pueda ser null, o que cumpla con la regex. Es un
nivel bÃ¡sico pero da un soporte de seguridad antes de almacenar cualquier cosa
incorrecta, siempre puedes equivocarte en una transformaciÃ³n.

<MdxImage
  src="/assets/blog/testing-on-data-engineering/testing-data-2.png"
  alt="data-schema-example"
></MdxImage>

## Quality Testing

Lo primero a recalcar en este tipo de tests es quÃ© es raro realizarlo de una
manera quÃ© funcione siempre porque las reglas de negocio van cambiando a lo
largo del tiempo. En mi caso es el test quÃ© mÃ¡s aporta y el mÃ¡s difÃ­cil de
generar, se podrÃ­a empezar definiendo los casos lÃ­mite que no se pueden dar en
los datos y continuando con criterios de aceptaciÃ³n. Si el proceso es muy grande
o tiene muchas transformaciones, puede ser extremadamente difÃ­cil intuir quÃ©
podrÃ­a salir al final de dichas transformaciones. Visto desde otro punto de
vista, puede ser un test de e2e caja negra dondÃ© esperamos un resultado
aceptable, apÃ³yate siempre allÃ­ dÃ³nde haya el conocimiento de lo quÃ© deberÃ­a de
dar y ve refinando nadie tiene una fÃ³rmula mÃ¡gica para saber si realmente estÃ¡
todo bien o mal.

<MdxImage
  src="/assets/blog/testing-on-data-engineering/testing-data-1.png"
  alt="data-quality-example"
></MdxImage>

## Contract Testing

Exportando la idea de cÃ³mo se definÃ­an los contratos entre dos sistemas
separados, se puede aplicar a nuestro caso de uso. Un ejemplo muy bueno serÃ­a
por ejemplo si dentro de los datos vienen un conjunto de mÃ©tricas â€œAâ€ y â€œBâ€, la
principal diferencia con los anteriores test consiste en mirar si realmente â€œAâ€
y â€œBâ€ existen en los datos, por lo que antes de realizar alguna transformaciÃ³n o
cÃ¡lculo deberemos validar las fuentes.

<MdxImage
  src="/assets/blog/testing-on-data-engineering/testing-data-3.png"
  alt="data-contract-example"
></MdxImage>

En un mundo ideal se podrÃ­a hablar con la fuente de los datos y establecer este
contrato, pero cÃ³mo no siempre es el caso te comentarÃ© que existe el â€œConsumer
Driven Contract Testingâ€ pero yo en mi caso adapto el concepto a la necesidad,
el cuÃ¡l es un test defensivo por si solo te pasasen â€œAâ€, darnos el aviso antes
de quÃ© sea tarde.

## Integrity Testing

Esto es para aquellos casos dÃ³nde generamos fichero con claves forÃ¡neas a otros
ficheros, por ejemplo tenemos una transformaciÃ³n que nos genera los datos ya
listos y con un cierto tipo de estructura, para quÃ© luego pueda ser migrado a la
base de datos. Este test lo quÃ© harÃ¡ es que si tenemos un key en un fichero
deberÃ­a de existir otra columna que hace referencia en a la key en el otro. Esto
me parece super Ãºtil a la hora de hacer transformaciones de datos, ya quÃ© nos
aporta un nivel mÃ¡s de seguridad.

<MdxImage
  src="/assets/blog/testing-on-data-engineering/testing-data-4.png"
  alt="data-integrity-example"
></MdxImage>

Tal cÃ³mo lo veo Data Engineering tiene un campo muy amplio dÃ³nde traer ideas de
testing y aportar mayor valor a tu trabajo, automatizando procesos y evitando
incertidumbre ya que escribir estos test harÃ¡ que puedas saber si algo estÃ¡ bien
o no ya quÃ© ahora el test te lo dice.

Un saludo y os animo a buscar valor de los test en tu empresa.
